<html>
  <head>
    <script>
      var actionSpy = jasmine.createSpy();
      var _satellite = {
        container: {
          extensions: {
            'test-extension': {
              displayName: 'Test Extension',
              modules: {
                'test-extension/events/test-event.js': {
                  displayName: 'Test Event',
                  script: getTestEventDelegate()
                },
                'test-extension/actions/test-action.js': {
                  displayName: 'Test Action',
                  script: function(module) {
                    module.exports = actionSpy;
                  }
                }
              }
            }
          },
          rules: [
            {
              events: [
                {
                  modulePath: 'test-extension/events/test-event.js'
                }
              ],
              actions: [
                {
                  modulePath: 'test-extension/actions/test-action.js'
                }
              ]
            }
          ]
        }
      };
    </script>
    <script src="/engine.js"></script>
  </head>
  <body>
    <script>
      _satellite.pageBottom();

      TestPage
        .execute(function() {
          _satellite.triggerTestEvent();
          expect(actionSpy).toHaveBeenCalled();
        })
        .start();
    </script>
  </body>
</html>
