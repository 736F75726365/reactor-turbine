<html>
  <head>
    <script src="/base/dist/container.js"></script>
    <script src="../../__tests__/helpers/configureEngineForEventTests.js"></script>
    <script>
      var actionSpy = jasmine.createSpy();
      var conditionSpy = jasmine.createSpy().and.returnValue(true);
      configureActionForEventTests(actionSpy);
      configureRuleForEventTests([{type: 'dtm.onload'}], conditionSpy);
    </script>
    <script src="/base/dist/engine.js"></script>
    <script src="/base/src/__tests__/helpers/testpage.js"></script>
    <script>
      TestPage
        .execute(function() {
          expect(actionSpy.calls.count()).toEqual(0);
        })
        .waitForContentLoaded()
        .execute(function() {
          expect(actionSpy.calls.count()).toEqual(1);
          expect(conditionSpy.calls.mostRecent()).toEqual({
            object: document.location,
            args: [{type: 'windowload', target: document.location}, document.location],
            returnValue: true
          });
        })
        .start();
    </script>
  </head>
  <body>
    <script>
      _satellite.pageBottom();
    </script>
  </body>
</html>
