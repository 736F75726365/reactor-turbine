<html>
<head>
  <script src="/base/dist/config.js"></script>
  <script src="configureEngineForEventTests.js"></script>
  <script>
    var actionSpy = jasmine.createSpy();
    jasmine.clock().install();
    configureEngineForEventTests([{ type: 'dtm.domReady' }], actionSpy);
  </script>
  <script src="/base/dist/engine.js"></script>
  <script src="/base/src/__tests__/testpage.js"></script>
  <script>
    TestPage
      .execute(function() {
        // Actions are always run asynchronously.
        jasmine.clock().tick(1);
        expect(actionSpy.calls.count()).toEqual(0);
      })
      .waitForDOMLoaded()
      .execute(function() {
        // Actions are always run asynchronously.
        jasmine.clock().tick(1);
        expect(actionSpy.calls.count()).toEqual(1);
        jasmine.clock().uninstall();
      })
      .start();
  </script>
</head>
<body>
  <script>
    _satellite.pageBottom();
  </script>
</body>
</html>
